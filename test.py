from td_api import Account
from data_handler import DataHandler
import pandas as pd
# from datetime import datetime, timedelta

acc = Account("keys.json")

# x = np.linspace(1000, 2500)
# y = [option_price(r, 1854, 100) for r in x]

# acc = Account("keys.json")

# symbol = "TSLA"
# days = 8
# strike_count = 50

# from_date = datetime.now()
# to_date = from_date + timedelta(days=days)
# data = acc.get_options_chain(symbol, from_date, to_date, strike_count=strike_count)
# mark = acc.get_quotes([symbol])["mark"].iloc[0]

# plt.plot(x, y)
# plt.scatter(data["strikePrice"], data["mark"])
# plt.show()

#symbols = 'GOOGL_082820P1485,GOOGL_082820P1490,GOOGL_082820P1495,GOOGL_082820P1500,GOOGL_082820P1505,GOOGL_082820P1510,GOOGL_082820P1515,GOOGL_082820P1520,GOOGL_082820P1525,GOOGL_082820P1530,GOOGL_082820P1535,GOOGL_082820P1540,GOOGL_082820P1545,GOOGL_082820P1550,GOOGL_082820P1555,GOOGL_082820P1560,GOOGL_082820P1565,GOOGL_082820P1570,GOOGL_082820P1575,GOOGL_082820P1580,GOOGL_082820P1585,GOOGL_082820P1590,GOOGL_082820P1595,GOOGL_082820P1600,GOOGL_082820P1605,GOOGL_082820P1610,GOOGL_082820P1615,GOOGL_082820P1620,GOOGL_082820P1625,GOOGL_082820P1630,GOOGL_082820P1635,GOOGL_082820P1640,GOOGL_082820P1650,GOOGL_082820P1660,GOOGL_082820P1670,GOOGL_082820P1680,GOOGL_082820P1690,GOOGL_082820P1700,GOOGL_082820P1710,GOOGL_082820P1720,GOOGL_082820P1730,GOOGL_082820P1740,GOOGL_082820P1750,GOOGL_082820P1760,GOOGL_090420P1455,GOOGL_090420P1460,GOOGL_090420P1465,GOOGL_090420P1470,GOOGL_090420P1475,GOOGL_090420P1480,GOOGL_090420P1485,GOOGL_090420P1490,GOOGL_090420P1495,GOOGL_090420P1500,GOOGL_090420P1505,GOOGL_090420P1510,GOOGL_090420P1515,GOOGL_090420P1520,GOOGL_090420P1525,GOOGL_090420P1530,GOOGL_090420P1535,GOOGL_090420P1540,GOOGL_090420P1545,GOOGL_090420P1550,GOOGL_090420P1555,GOOGL_090420P1560,GOOGL_090420P1565,GOOGL_090420P1570,GOOGL_090420P1575,GOOGL_090420P1580,GOOGL_090420P1585,GOOGL_090420P1590,GOOGL_090420P1595,GOOGL_090420P1600,GOOGL_090420P1605,GOOGL_090420P1610,GOOGL_090420P1615,GOOGL_090420P1620,GOOGL_090420P1625,GOOGL_090420P1630,GOOGL_090420P1635,GOOGL_090420P1640,GOOGL_090420P1650,GOOGL_090420P1660,GOOGL_090420P1670,GOOGL_090420P1680,GOOGL_090420P1690,GOOGL_090420P1700,GOOGL_090420P1710,GOOGL_090420P1720,GOOGL_090420P1730,GOOGL_090420P1740,GOOGL_090420P1750,GOOGL_090420P1760,GOOGL_091120P1455,GOOGL_091120P1460,GOOGL_091120P1465,GOOGL_091120P1470,GOOGL_091120P1475,GOOGL_091120P1480,GOOGL_091120P1485,GOOGL_091120P1490,GOOGL_091120P1495,GOOGL_091120P1500,GOOGL_091120P1505,GOOGL_091120P1510,GOOGL_091120P1515,GOOGL_091120P1520,GOOGL_091120P1525,GOOGL_091120P1530,GOOGL_091120P1535,GOOGL_091120P1540,GOOGL_091120P1545,GOOGL_091120P1550,GOOGL_091120P1555,GOOGL_091120P1560,GOOGL_091120P1565,GOOGL_091120P1570,GOOGL_091120P1575,GOOGL_091120P1580,GOOGL_091120P1585,GOOGL_091120P1590,GOOGL_091120P1595,GOOGL_091120P1600,GOOGL_091120P1605,GOOGL_091120P1610,GOOGL_091120P1615,GOOGL_091120P1620,GOOGL_091120P1625,GOOGL_091120P1630,GOOGL_091120P1635,GOOGL_091120P1640,GOOGL_091120P1650,GOOGL_091120P1660,GOOGL_091120P1670,GOOGL_091120P1680,GOOGL_091120P1690,GOOGL_091120P1700,GOOGL_091120P1710,GOOGL_091120P1720,GOOGL_091120P1730,GOOGL_091120P1740,GOOGL_091120P1750,GOOGL_091120P1760,GOOGL_091820P1455,GOOGL_091820P1460,GOOGL_091820P1465,GOOGL_091820P1470,GOOGL_091820P1475,GOOGL_091820P1480,GOOGL_091820P1485,GOOGL_091820P1490,GOOGL_091820P1495,GOOGL_091820P1500,GOOGL_091820P1505,GOOGL_091820P1510,GOOGL_091820P1515,GOOGL_091820P1520,GOOGL_091820P1525,GOOGL_091820P1530,GOOGL_091820P1535,GOOGL_091820P1540,GOOGL_091820P1545,GOOGL_091820P1550,GOOGL_091820P1555,GOOGL_091820P1560,GOOGL_091820P1565,GOOGL_091820P1570,GOOGL_091820P1575,GOOGL_091820P1580,GOOGL_091820P1585,GOOGL_091820P1590,GOOGL_091820P1595,GOOGL_091820P1600,GOOGL_091820P1605,GOOGL_091820P1610,GOOGL_091820P1615,GOOGL_091820P1620,GOOGL_091820P1630,GOOGL_091820P1640,GOOGL_091820P1650,GOOGL_091820P1660,GOOGL_091820P1670,GOOGL_091820P1680,GOOGL_091820P1690,GOOGL_091820P1700,GOOGL_091820P1710,GOOGL_091820P1720,GOOGL_091820P1730,GOOGL_091820P1740,GOOGL_091820P1750,GOOGL_091820P1760,GOOGL_091820P1770,GOOGL_091820P1780,GOOGL_082820C1455,GOOGL_082820C1460,GOOGL_082820C1465,GOOGL_082820C1470,GOOGL_082820C1475,GOOGL_082820C1480,GOOGL_082820C1485,GOOGL_082820C1490,GOOGL_082820C1495,GOOGL_082820C1500,GOOGL_082820C1505,GOOGL_082820C1510,GOOGL_082820C1515,GOOGL_082820C1520,GOOGL_082820C1525,GOOGL_082820C1530,GOOGL_082820C1535,GOOGL_082820C1540,GOOGL_082820C1545,GOOGL_082820C1550,GOOGL_082820C1555,GOOGL_082820C1560,GOOGL_082820C1565,GOOGL_082820C1570,GOOGL_082820C1575,GOOGL_082820C1580,GOOGL_082820C1585,GOOGL_082820C1590,GOOGL_082820C1595,GOOGL_082820C1600,GOOGL_082820C1605,GOOGL_082820C1610,GOOGL_082820C1615,GOOGL_082820C1620,GOOGL_082820C1625,GOOGL_082820C1630,GOOGL_082820C1635,GOOGL_082820C1640,GOOGL_082820C1650,GOOGL_082820C1660,GOOGL_082820C1670,GOOGL_082820C1680,GOOGL_082820C1690,GOOGL_082820C1700,GOOGL_082820C1710,GOOGL_082820C1720,GOOGL_082820C1730,GOOGL_082820C1740,GOOGL_082820C1750,GOOGL_082820C1760,GOOGL_090420C1455,GOOGL_090420C1460,GOOGL_090420C1465,GOOGL_090420C1470,GOOGL_090420C1475,GOOGL_090420C1480,GOOGL_090420C1485,GOOGL_090420C1490,GOOGL_090420C1495,GOOGL_090420C1500,GOOGL_090420C1505,GOOGL_090420C1510,GOOGL_090420C1515,GOOGL_090420C1520,GOOGL_090420C1525,GOOGL_090420C1530,GOOGL_090420C1535,GOOGL_090420C1540,GOOGL_090420C1545,GOOGL_090420C1550,GOOGL_090420C1555,GOOGL_090420C1560,GOOGL_090420C1565,GOOGL_090420C1570,GOOGL_090420C1575,GOOGL_090420C1580,GOOGL_090420C1585,GOOGL_090420C1590,GOOGL_090420C1595,GOOGL_090420C1600,GOOGL_090420C1605,GOOGL_090420C1610,GOOGL_090420C1615,GOOGL_090420C1620,GOOGL_090420C1625,GOOGL_090420C1630,GOOGL_090420C1635,GOOGL_090420C1640,GOOGL_090420C1650,GOOGL_090420C1660,GOOGL_090420C1670,GOOGL_090420C1680,GOOGL_090420C1690,GOOGL_090420C1700,GOOGL_090420C1710,GOOGL_090420C1720,GOOGL_090420C1730,GOOGL_090420C1740,GOOGL_090420C1750,GOOGL_090420C1760,GOOGL_091120C1455,GOOGL_091120C1460,GOOGL_091120C1465,GOOGL_091120C1470,GOOGL_091120C1475,GOOGL_091120C1480,GOOGL_091120C1485,GOOGL_091120C1490,GOOGL_091120C1495,GOOGL_091120C1500,GOOGL_091120C1505,GOOGL_091120C1510,GOOGL_091120C1515,GOOGL_091120C1520,GOOGL_091120C1525,GOOGL_091120C1530,GOOGL_091120C1535,GOOGL_091120C1540,GOOGL_091120C1545,GOOGL_091120C1550,GOOGL_091120C1555,GOOGL_091120C1560,GOOGL_091120C1565,GOOGL_091120C1570,GOOGL_091120C1575,GOOGL_091120C1580,GOOGL_091120C1585,GOOGL_091120C1590,GOOGL_091120C1595,GOOGL_091120C1600,GOOGL_091120C1605,GOOGL_091120C1610,GOOGL_091120C1615,GOOGL_091120C1620,GOOGL_091120C1625,GOOGL_091120C1630,GOOGL_091120C1635,GOOGL_091120C1640,GOOGL_091120C1650,GOOGL_091120C1660,GOOGL_091120C1670,GOOGL_091120C1680,GOOGL_091120C1690,GOOGL_091120C1700,GOOGL_091120C1710,GOOGL_091120C1720,GOOGL_091120C1730,GOOGL_091120C1740,GOOGL_091120C1750,GOOGL_091120C1760,GOOGL_091820C1455,GOOGL_091820C1460,GOOGL_091820C1465,GOOGL_091820C1470,GOOGL_091820C1475,GOOGL_091820C1480'
# #symbols = 'GOOGL_082820P1485,GOOGL_082820P1490,GOOGL_082820P1495'
# n = 20
# print(len(symbols))
# symbols = symbols.split(',')[10:]
# print(len(symbols))
# # symbols = [symbols[i:i + n] for i in range(0, len(symbols), n)] 
# # for val in symbols:
# #     print(val)
# #     account = Account("keys.json")
# #     quote = account.get_quotes(val)
# #     print(quote)
# #     if not isinstance(quote, pd.DataFrame):
# #         break

# account = Account("keys.json")
# quote = account.get_quotes(symbols)
# print(quote)
# d = {'col1': [1, 2], 'col2': [3, 4]}
# df_1 = pd.DataFrame(data=d)
# d2 = {'col1': [5, 6], 'col2': [7, 8]}
# df_2 = pd.DataFrame(data=d2)
# df_1 = df_1.append(df_2, ignore_index = True)
# print(df_1)
#symbols = symbols.split(',')
#print(symbols[len(symbols)//2:])
#print(symbols.split(',')[len(symbols)//2:])
#print(symbols.split(',')[:len(symbols)//2])

# data_handler = DataHandler("vol500k", "v=111&f=sh_avgvol_o500")
# data_handler.save_finviz()
# data = pd.read_hdf('data/vol500k/finviz.h5')
# for ticker in data.index:
#     open('temporary.txt', 'a+').write(ticker +'\n')
print(acc.get_positions().keys())
